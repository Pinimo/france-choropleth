---
title: Articles
permalink: /
---

<div id="map"></div>

<script>
var iOS = ( navigator.userAgent.match(/(iPad|iPhone|iPod)/g) ? true : false );

var map = L.map('map',{zoomAnimation:iOS})
           .setView([46.6, 2.1], 6)
           .addLayer(new L.tileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png',{
              subdomains: 'abcd',
              detectRetina: true,
              minZoom: 6,
              maxZoom: 12
          }));

function draw(file, cl){
  var svg = d3.select(map.getPanes().overlayPane)
              .append("svg").classed(cl, true),
        g = svg.append("g");
  if(iOS){svg.classed("leaflet-zoom-hide", true);}

  d3.json(file, function(collection) {
    if (collection.type === "Topology") {
      for (key in collection.objects) {
        collection = topojson.feature(collection, collection.objects[key]);
      }
    }
    path = d3.geo.path().projection(d3.geo.transform({point: function(x,y) {
      var point = map.latLngToLayerPoint(new L.LatLng(y, x));
      this.stream.point(point.x, point.y);
      }
    })
  );

    var p = g.selectAll("path")
             .data(collection.features)
             .enter().append("path");

    map.on("viewreset", reset);
    reset();

    function reset() {
      var bounds = path.bounds(collection),
      topLeft = bounds[0],
      bottomRight = bounds[1];

      svg .attr("width", bottomRight[0] - topLeft[0])
          .attr("height", bottomRight[1] - topLeft[1])
          .style("left", topLeft[0] + "px")
          .style("top", topLeft[1] + "px");

      g.attr("transform","translate("+-topLeft[0]+","+-topLeft[1]+")");
      p.attr("d", path).classed(cl, true);
    }
  });
};

draw("data/geo/topo/cantons.json","communes");
draw("data/geo/topo/departements.json","departements");
 
 map.on('zoomend', function() {
   if(map.getZoom()>6){
     d3.select(".departements").style("display","none");
   }
   if(map.getZoom()<=6){
     d3.select(".departements").style("display","block");
   }
 });

</script>
