---
title: Articles
permalink: /
---

<div id="map"></div>

<script>
var map = L.map('map').setView([46.6, 2.1], 6)
           .addLayer(new L.tileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png',{
              subdomains: 'abcd',
              detectRetina: true,
              minZoom: 6, maxZoom: 12 })),
          a = {};

function draw(data, cl, layer){
  if (data.type === "Topology") {
    for (key in data.objects) {
      geojson = topojson.feature(data, data.objects[key]);
      layer.addLayer(new L.GeoJSON(geojson,{className: cl,
        onEachFeature: function (feature, layer) {
          if (cl === "departements"){
            a[feature.properties.insee] = layer.getBounds();
          }
        }
      }))
    }
  }
}

function communes(){
  for (e in a){
    if (map.getBounds().contains(a[e]) || map.getBounds().intersects(a[e])){
      d3.json("data/geo/topo/"+e+".json", function(json){
        draw(json, "communes", france);
        france.addTo(map);
      });
    }
  }
}

d3.json("data/geo/topo/cantons.json", function(cantons){
  var france = new L.layerGroup();
  draw(cantons, "cantons", france);
  d3.json("data/geo/topo/departements.json", function(departements){
    draw(departements, "departements", france);
    france.addTo(map);
  });
});

map.on('zoomend', function() {
  if(map.getZoom()>6 && map.getZoom()<=8){
    d3.selectAll(".departements").style("display","none");
    d3.selectAll(".cantons").style("display","block");
  }
  if(map.getZoom()<=6){
    d3.selectAll(".departements").style("display","block");
  }
  if(map.getZoom()>8){
    d3.selectAll(".cantons").style("display","none");
  }
});

</script>
